
<style>
       /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
    </style>
<h3>My Google Maps Demo</h3>
<!--The div element for the map -->
<div id="map"></div>
<script>
    // Initialize and add the map
    function initMap() {
        // The location of Uluru
        
        var user = {lat: <%= @user_location[0] %>, lng: <%= @user_location[0] %>}
        // The map, centered at Uluru
        var map = new google.maps.Map(
            document.getElementById('map'), {zoom: 4, center: user});
        // The marker, positioned at Uluru
        var marker = new google.maps.Marker({position: user, map: map});
        <% @listings.each do |listing| %>
            var location = {lat: <%= listing.latitude / 10**7 %>, lng: <%= listing.longitude/ 10**7 %>}
            var marker2 = new google.maps.Marker({position: location, map: map});
        <% end %>
    }
</script>

<!--Load the API from the specified URL
* The async attribute allows the browser to render the page while the API loads
* The key parameter will contain your own API key (which is not needed for this tutorial)
* The callback parameter executes the initMap() function
-->


<script async defer
    src=<%= "https://maps.googleapis.com/maps/api/js?key=#{Rails.application.credentials.googleapi}&callback=initMap" %>>
</script>